= 基于国产龙芯Loongson 2K1000LA 工业控制开发板

Banana Pi BPI-5202作为单纯的嵌入式通用控制器软硬件开发平台，采用龙芯2K1000LA芯片设计，基本配置中有2个独立MAC以太网端口、2个RS485端口+1个RS232端口+2个CAN2.0端口，配置灵活，为应用开发者提供功能齐全的硬件解决方案。提供较强算力的边缘计算支持。开发者可以快速利用开发平台，进行开发并产品化

image::/bpi-5202/bpi-5202_banner_en_2.jpg[bpi-5202_banner_en_2.jpg]

TIP: 全志科技 A40i 方案设计 link:/zh/BPI-6202/BananaPi_BPI-6202[香蕉派 BPI-6202] 工业控制网关  +
中科龙芯 2K1000LA 方案设计: link:/zh/BPI-5202/BananaPi_BPI-5202[香蕉派 BPI-5202] 嵌入式工业控制网关计算机 + 
中科龙芯 3A6000 方案设计: link:/zh/BPI-3A6000/BananaPi_BPI-3A6000[香蕉派 BPI-3A6000] 工业级迷你计算机

== 龙芯CPU架构简介
* 龙芯CPU是龙芯中科自主研发的具有完整自主知识产权的CPU产品。
* 龙芯CPU面向国家信息化建设的需求，面向国际信息技术前沿，以安全可控为主题，以产业发展为主线，以体系建设为目标，坚持自主创新，掌握计算机软硬件的核心技术，为国家安全战略需求提供自主、安全、可靠的处理器，为信息产业及工业信息化的创新发展提供高性能、低成本、低功耗的处理器。
* 龙芯CPU系列产品包括：面向行业应用的专用小CPU、面向工控和终端类应用的中CPU、以及面向桌面与服务器类应用的大CPU。在国家安全、电脑及服务器、工控及物联网等领域与合作伙伴展开广泛的市场合作。
* 龙芯嵌入式CPU（1系列和2系列）主要应用于网络通信安全产品、指纹密码产品、工控互联网、行业应用等领域，与板卡、软件、整机厂商建立了紧密的合作关系。
* 国内主要网安企业的国产防火墙、交换机、网闸、路由器、各类数据通讯终端等产品，均使用龙芯CPU研发；在工控互联网领域，PLC、DTU、FSU、集中器、网络开票机、交通灯、门禁门锁、工控集终端等，正在快速增长。在SOC设计领域：行业SOC、数字电视、机顶盒、电力SOC等。

== 龙芯2K1000LA CPU简介 

* 龙芯2K1000LA处理器是面向网络安全、移动智能终端、高性能边缘计算场景应用需求的双核处理器芯片。龙芯2K1000 处理器集成两个GS264 处理器核，芯片外围接口包括两路x4 PCIE2.0、一路SATA2.0、4 路USB2.0、两路DVO、64 位DDR2/3，及其它各种小接口。该芯片可以满足中低端网络安全领域应用需求，并为其扩展应用提供相应的接口。
* 龙芯2K1000LA处理器，是全新的LoongArch架构处理器，与2K1000实现了PIN2PIN兼容。对比2K1000，2k1000LA性能提升20%，功耗降低20%，更重要的是，LoongArch架构彻底摆脱了MIPS架构，是目前我国唯一具有完整自主知识产权的自主指令集的CPU架构产品。

== 适用对象

* 需要采用完全国产化自主可控产品，特别是以龙芯嵌入式架构形成信创工业产品
* 通过既往经验，认识到以“购买核心板+自研底板”的方式研发产品，效率低、时间长、价格高、调试工作量大
* 面临不同应用需求，在不断研发新品的过程中，不断重复调试/适配各种驱动、中间件、数据接口时
* 为满足不同需求，需要不断重构软件模块，但因缺少软件开发工具，无法保证软件成熟度与软件质量
* 当出现以“核心板+底板“的方式，在应用中面临扩展性、可靠性、稳定性、抗干扰性不足的困扰
* 为尽快实现产品上市，不愿从头设计，而计划采用成熟的硬件+工具软件+应用功能整合的方案
* 为推出创新性的产品，需要整合不同的软件功能，或自研、或开源都无法满足要求时

== 独特优势

* 单板工控机，融合大量应用场景的需求，完整输出CPU的IO资源，无需重复设计IO功能扩展，研发更高效
* 单板工控机，工业级设计，品质更有保证，抗电磁干扰性能更强、继承性更好，生命周期运行更稳定
* 单板工控机，通过PCIe、内部高速总线等方式，与更多扩展功能板卡互联
* 工控开发组件（可选），提供基于硬件/驱动上的IO通信与控制、协议解析与转发、扩展数据接口功能
* 工控应用产品包（可选），通过应用开发工具，快速构建各种工控应用产品，确保可靠性和多样性

== 支持ARM架构/全国产化自主可控（龙芯LoongArch）架构和运行环境

* 龙芯（LoongArch）、飞腾/全志/瑞星微（ARM）等硬件架构下，实现了软件中间件+应用功能模块全兼容
* 能够满足板卡元器件100%国产化的需求
* 能够满足软件中间件/应用功能模块国产化率（自研率）99%以上要求

= 硬件

== BPI-5202 PCBA 硬件设计

=== PCBA 硬件接口

image::/indu-board/bpi-5020_en_int.jpg[bpi-5020_en_int.jpg]

=== PCBA 硬件规格

[cols="2,6"]
|====
| 处理器及OS	| 龙芯2K1000LAi 双核1.0GHz,Loongnix、LoongOS、LxAMP、麒麟V10
| 内存	| 4G DDR3，可配大容量SSD硬盘
| 基本通信功能	| 以太网口：2 x 1000M自适应，独立MAC,2 x RSRS485+1 x RS232+ 2 x CAN 2.0，带隔离,4G全网通
| 扩展功能模块	| 5个扩展槽位，以下模块任意组合,7 x RS485：带隔离（最多支持1个板卡扩展）;16 x DI：无源输入型，模块提供24V隔离电源;16 x DO：光耦继电器输出型，最大负载60V/500MA;8 x DI + 8 DO：继电器输出型，NC、COM、NO节点;8 x AI + 4 xAO：0-5V/4-
20mA;其它定制模块

| HMI接口	| HDMI
| USB	| USB支持键盘、鼠标；或电阻/电容显示屏接口
| 电源	| DC24V电源输入,24V隔离输出，IO板使用，500mA
                                                       
|==== 
         

=== 硬件扩展

为满足现场复杂的电气量接入需求，BPI-5202设计了5个可扩展IO槽位，每个IO槽位可根据需要配置为16xDI、16xDO、8xDI+8xDO、8xAI+4AO中的任意一种IO板卡，配合提供灵活多变的配置组合方式，并可以根据用户和项目的需求，定制各种功能板卡.

BPI-5202扩展口采用2.54mm 间距，2x10P 排针座，用来扩展IO接口。

image::/bpi-5202/banana_pi_bpi-5202_excend_sch.png[banana_pi_bpi-5202_excend_sch.png]

BPI-5202支持模块化设计，提供丰富的扩展接口，可以采用基本单元 + 5个扩展单元，支持按需配置。扩展IO单元模块包括：

* 7 x RS485模块，带隔离
* 16 x DI模块（开关输入模块），无源输入（最多支持5个模块混插）
* 16 x DO模块(开关输出模块)，继电器输出（最多支持5个模块混插）
* 8 x DI+8 x DO O模块(开关输入/输出模块)，继电器输出（最多支持5个模块混插）
* 8 x AI + 4 x AO 模块（模拟量输入输出模块），支持0-5V、0-20mA输入
* 可根据需求定制Lora、ZigBee、433M无线传输模块、电力线载波模块、以及其它功能模块
* 支持第三方自行定制功能板卡，并与BPI-5202实现通信

所有电路板都通过内部总线(485或SPI)连接在盒子里

image::/indu-board/banana_pi_bpi-6202_gateway_5.jpg[banana_pi_bpi-6202_gateway_5.jpg]

Banana Pi BPI-5202 全功能扩展网关设计

image::/indu-board/banana_pi_bpi-6202_gateway_1.jpg[banana_pi_bpi-6202_gateway_1.jpg]

= 基于BPI-5202 的产品介绍

BPI-5202S，是基于龙芯2K1000LA CPU研发的工业级、具有可信计算功能的高性能嵌入式单板工控机，主板板卡具有强大的计算性能，内存/存储可扩，IO接口丰富；采用CPU+IO底板的整体设计，抗干扰性更强，品质更稳定，生命周期更长，能满足各种工业现场复杂的应用要求。

BPI-5202S提供了内置的基于PCIe和高速RS485的总线接口，便于连接更多的IO功能板，满足更加多样化的、更加专业化的应用需求。

BPI-5202S已经实现了所有元器件的100%国产化。

在强大的硬件架构之上，吉斯凯达公司集成具有完整自主知识产权的众多软件功能（可选），通过吉斯凯达公司提供的开发组件和应用产品功能包的选择，实现（且不限于）如下功能：

* 协议转换功能300+工业通用/行业专用协议库
* 音视频处理：音视频接入传输/控制/录像/联动功能
* 边缘计算：边缘计算编程功能
* 网络安全：工业防火墙功能
* PLC：支持IEC61131编程
* 300+工业通用/行业专用协议库
* 视频接入传输/控制/录像/联动功能
* 电气IO量采集控制功能（AI/AO/DI/DO）
* 工业控制器：支持各种算法的灵活定义和数据的共享
* C/S架构SCADA系统
* B/S架构SCADA系统

BPI-5202为导轨式安装方式，外观如下图所示。

image::/bpi-5202/banana_pi_bpi-5202_8.jpg[banana_pi_bpi-5202_8.jpg]

== 硬件型态

为满足工业产品不同的开发和应用标准与需求，BPI-5202提供了多种硬件形态的产品，均为可以立即使用的，工业级工业控制/IOT产品。

=== 单板、单板整机

BPI-5202，有多种产品形态：

* 单板方式：单独的板卡
* 原厂定制机壳方式：采用社区专门定制的机壳
* 开发者定制机壳方式：采用开发者自己定制的机壳、机箱

image::/bpi-5202/bpi-5202_case_1.png[bpi-5202_case_1.png]

image::/bpi-5202/bpi-5202_case_2.png[bpi-5202_case_2.png]

=== 多板整机的各种组合模式

为满足现场不同的应用需求，BPI-5202 能够以主控板为基础，扩展各种IO板卡，组合成各种的多板整机形态（需在交付时指明），包括但不限于以下形态：

image::/bpi-5202/bpi-5202_case_3.jpg[bpi-5202_case_3.jpg]

* BPI-5202：1-2联典型应用模式

image::/bpi-5202/bpi-5202_case_4.jpg[bpi-5202_case_4.jpg]

* BPI-5202：3联典型应用模式

image::/bpi-5202/bpi-5202_case_5.jpg[bpi-5202_case_5.jpg]

* BPI-5202：7联典型应用模式

image::/bpi-5202/bpi-5202_case_6.jpg[bpi-5202_case_6.jpg]

=== BPI-5202系统的层次结构

为适应不同层次的开发能力与开发需求，全系统由硬件核心到软件外延，分为三个相对独立、但能紧密耦合的三个功能层：单板工控机、开发组件、应用产品包。

* 1．核心层：单板工控机
** 在嵌入式工业级CPU上开发的高性能单板工控机，具有满足各类工控/物联网应用需求的资源、算力、IO接口，并具有承载高性能工控组件和工控应用运行的能力。
** 通过多种高速数据总线接口，能够扩展更多的功能板卡，满足各种应用场景的实际需求。
* 2．组件层：工控开发组件iDevToolkit
** iDevToolkit工控开发组件，由协议解析器框架、C/S架构服务框架、B/S架构服务框架、MQTT服务器框架、视频服务框架、及实时数据库API、关系数据库API、时序数据库API等组件构成。
** 开发者利用iDevToolkit工控开发组件，以多种编程语言，通过各类数据接口和服务接口，存取、处理数据，实现自己的业务流程，从而在5202的弹性硬件平台上，自行实现各类工业级的产品。
* 3．应用层：工控应用产品包iCtrlPkg
** iDevPkg工控应用产品包，是基于iDevToolkit开发出的一系列成熟的、功能强大的、可以灵活定制和裁剪的、具有大量案例的工业控制/IOT产品；依照同样的技术路径，不同的开发者，借助iDevToolkit，也能开发出更多样、更优秀、更强大的工业控制/IOT产品。

== BPI-5202产品典型应用场景

适用于国产化自主可控需求中涉及多通道/多协议接入、数据处理与整合、监控、SCADA和轻量级PLC的应用场景：

* 变电站/配电间自动化系统中各类（串口/网口/IO电气量）数据采集单元、测控装置、保护设备的接入、协议解析、报警处理、转换、整合传输与控制
* 机房动力环境监控、泵房监控系统中各类（串口/网口/IO电气量）自动化控制设备、PLC、变频器设备的接入、协议解析、报警处理、转换、整合传输与控制
* 智慧城市、智慧园区、智慧校园系统中各类（串口/网口/电气量IO）物联网传感器设备、控制设备的接入、协议解析、报警处理、转换、整合传输与控制
* 智能配电房、机房动力环境、泵站、智慧园区、智慧校园、智能制造等现场的视频前段设备接入
配合后台API和平台，为应用开发商和用户提供不依赖视频厂家SDK和后台系统的低成本、易开发的独立安全的视频监控整合方案

== BPI-5202主要特点

* 1,工业成品与应用开发平台, BPI-5202嵌入式通用工业控制器，有三个不同的角色：

** 作为工业成品：以其所具有的功能（轻量级PLC、协议网关、视频网关、综合网关、嵌入式SCADA系统等各种角色），直接应用于工程项目现场
** 作为二次开发的基础平台，为应用开发者提供各类开发工具和协议解析数据库接口，大大缩短各类行业应用产品的开发周、降低开发难度
作为单纯的国产化自主可控的嵌入式通用控制器软硬件平台，为应用开发者提供较强算力的边缘计算支持
* 2,工业级标准:

** 工业级低功耗设计，现场长期稳定运行
** 支持-40℃~+85℃宽温运行（高温环境下需选配合适的散热片/风扇）
** 执行GB/T17626、GB/T15153、IEC61850-3、EN61000-6-5标准，EMC III级
** 支持双机冗余
* 3,可扩展功能

** 支持定制外壳的板卡扩展，包括电气IO模块（AI / AO /DI /DO模块）、扩展串口模块、扩展以太网交换模块、HPLC通信模块、CAN通信模块、Zigbee通信模块、Lora通信模块，以及其他行业应用的定制模块，采用内部高速总线与6202主板通信

* 4,数据+视频现场整合

** 多年积累的300+国际/国家/行业/企业协议库，即插即连，提高接入效率，解析数据准确
** 视频RTSP/RTMP，Onvif/GB28181功能，流媒体服务器功能，H.264/H.265播放功能，数据联动短视频联动报警录像功能，摄像头  AI分析事件捕获/上传功能（近期发布），数据OSD打码功能（近期发布）
** 解决长期以来视频监控独立于数据监控、需要视频厂家前端+后端绑定方案痼疾和痛点

* 5,轻量级PLC功能

** 通过IEC61131-3编程语言，可针对网关内所有数据进行PLC方式编程，通过电气IO模块，实现轻量级PLC功能

* 6,多种南向/北向通信方式

** 支持2个独立MAC千兆自适应网口
** 支持2个RS485和1个RS232串口；通过机箱扩展和扩展板，可以多支持7个RS485
** 支持2路CAN接口；
** 支持扩展WIFI、4G/5G通信

* 7,HMI及上位机功能集成

** 通过HDMI/USB接口连接触摸屏/大屏-键盘-鼠标，应用程序可实现友好的HMI交互
** 配合内置的全功能SCADA系统（C/S架构和B/S架构），取代现场X86+Windows架构的上位机计算机系统，适合无人值守环境，具有极高的性价比

* 8,多核架构、资源丰富、算力充裕
** 龙芯高性能处理器2K1000LA，主频1.0GHz，4G DDR3
** 1 x M.2 SATA硬盘接口，可接入SSD硬盘
** 1 x mini PCIE接口，可接入4G模块、Wifi模块或AI算力卡；
** 内置软件狗加密芯片
** 可信平台模块，保障设备与通信安全

* 9,多种二次开发接口

** C、表达式、梯形图、Java、Python、SqLite编程接口
** Docker功能

== 内部逻辑结构

image::/bpi-5202/bpi-5020_1.png[bpi-5020_1.png]

== 外部连接方式

image::/bpi-5202/banana_pi_bpi-5202_way.png[banana_pi_bpi-5202_way.png]

== BPI-5202技术说明

为满足各关键行业项目对国产化自主可控产品的需要，而特别设计的BPI-5202，基本配置中有2个独立MAC以太网端口、2个RS485端口+1个RS232端口+2个CAN2.0端口，配置灵活，广泛适用于军工、电力、石油、厂矿、及物联网行业的自动化监控场合

为满足现场复杂的电气量接入需求，BPI-5202设计了5个可扩展IO槽位，每个IO槽位可根据需要配置为16xDI、16xDO、8xDI+8xDO、8xAI+4AO中的任意一种IO板卡，配合提供灵活多变的配置组合方式，并可以根据用户和项目的需求，定制各种功能板卡

BPI-5202内置300+规约解释库和实时数据库，可连接国内外各种保护装置、测控装置、IEDs等设备，并支持IEC61850。可根据用户要求定制特殊规约；提供开放的API，方便用户自行开发规约软件，规约软件可独立下载

BPI-5202支持近百台设备的接入，数据协议解析、转换与统一传输

BPI-5202具有强大的视频处理能力，包括RTSP/RTMP视频推拉流、Onvif/GB28181协议栈等视频监控传输功能，实现对多厂家视频前端设备（IPC、NVR）的兼容接入，配置大容量硬盘后可取代NVR，实现视频录像及回放功能。独有的基于数据+视频的联动功能，提供了业界唯一的数据+视频完美融合的解决方案

BPI-5202通过HDMI显示接口和USB键盘鼠标（或触摸屏），支持2048点以下完整的SCADA系统功能

BPI-5202支持三种配置方式：

* 内置WEB管理，通过浏览器查询／配置设备的工作参数
* 专用的配置软件配置设备参数
* 云端远程管理，通过云端对参数进行配置和诊断，实现固件和应用程序的升级

BPI-5202使用了先进的数字隔离技术、RS485自动方向控制、RS485零延时传送技术，在设计上充分考虑了工业现场应用的特殊性，遵循EMI/EMC设计规范，适应各种严酷的工业现场和物联网现场，保障通信以及各种IO信号量的可靠

NOTE: 1)BPI-5202系列嵌入式边缘计算工控机采用DC24V供电。

== BPI-5202产品主要功能

* 1)内置300+通讯规约库（详见协议列表清单），包括：MQTT及其它物联网协议、BACNET、OPC UA、IEC 60870-5-101/103/104、CDT、SPABUS、标准MODBUS及数十个变种，即插即通；可根据需求快速定制特殊协议，可提供二次开发环境
* 2)支持西门子/AB/施耐德/三菱等各类PLC连接
* 3)支持IEC61850 Server/Client功能，实现传统规约与61850的双向转换
* 4)视频流获取、传输、分发，云台控制、本地流媒体服务器功能
* )加密传输、断点续传
* 6)内置RTC，提供高精度时间参考
* 7)模块化设计，基本单元 + 5个扩展单元，支持按需配置。扩展IO单元模块包括：
* 7 x RS485模块，带隔离
** 16 x DI模块（开关输入模块），无源输入（最多支持5个模块混插）
** 16 x DO模块(开关输出模块)，继电器输出（最多支持5个模块混插）
** 8 x DI+8 x DO O模块(开关输入/输出模块)，继电器输出（最多支持5个模块混插）
** 8 x AI + 4 x AO 模块（模拟量输入输出模块），支持0-5V、0-20mA输入
** 可根据需求定制Lora、ZigBee、433M无线传输模块、电力线载波模块、以及其它功能模块
** 支持第三方自行定制功能板卡，并与CS5202LS-IC实现通信
* 8)HDMI/USB接口，配合嵌入式SCADA系统的UI操作
* 9)本地设备配置管理，云端设备配置管理
* 10)Telnet、SNMP服务
* 11)电磁兼容性设计，符合国际相关标准，具有良好的抗干扰能力
* 12)可进行二次开发，提供完整的协议开发包，可定制各种协议
* 13)全功能SCADA功能
* 14)导轨式安装方式，造型美观，组屏方便

== BPI-5202 主要技术规格
[cols="2,6"]
|====
|项目|	说明
|处理器及OS	|龙芯2K1000LAi 双核1.0GHz,Loongnix、LoongOS、LxAMP、麒麟V10
|内存	|4G DDR3，可配大容量SSD硬盘
|基本通信功能 |	以太网口：2 x 1000M自适应，独立MAC;2 x RSRS485+1 x RS232+ 2 x CAN 2.0，带隔离;4G全网通
|扩展功能模块	|可选
|USB	|USB支持键盘、鼠标；或电阻/电容显示屏接口
|数据处理能力	|设备接入能力：<=64台（根据带宽和采样周期可调）;模拟量<8192;数字量<8192;控制量<8192;表达式计算定义、报警处理
|视频处理能力|	视频RTSP/RTMP、Onvif、GB28181;视频录像、回放;数据触发片段视频录像、上传;AI摄像头图像AI分析事件捕获、数据OSD打码;本地流媒体服务;H.264/H.265播放
|HMI接口	|HDMI
|SCADA功能	|全功能SCADA系统，处理点数：2048点
|开发环境|	C/表达式/梯形图/Java/Python等边缘计算二次开发环境
|加密芯片|	无
|电源 |	DC24V电源输入,24V隔离输出，IO板使用，500mA
|====

== 环境规格
[cols="2,6"]
|====
|项目	|说明
|工作温度	|-40~+60℃
|存储温度	|-40~+75℃
|工作湿度（RH）	|5%~95%无冷凝
|存储湿度（RH）|	5%~95%无冷凝
|海拔高度	|<5000m
|防雷	|内置防雷元件，支持户外使用，符合高等级EMC标准
|防护等级	|IP40
|散热方式	|无风扇自然散热
|电磁兼容|	EMC III级，GB/T17626、GB/T15153、IEC61850-3、EN61000-6-5
|安规	|GB/T7621-2008
|认证	|CE认证
|====

== 物理规格
[cols="2,6"]
|====
|尺寸（宽x深x高）	|36mm x105mm x 145mm，导轨式安装,定制扩展的宽度为30mm x n+6（n≥2，为定制扩展时的宽度）
|重量	|0.5kg
|功耗	|典型功耗：5W ,最大功耗：10W
|====

= 嵌入式工控机

== 嵌入式工控机的定义与应用场景

工控机（Industrial Personal Computer，简称IPC），是上世纪90年代开始出现的、广泛应用于工业现场监视与控制的加固、增强型微型计算机，工控机常常会在环境比较恶劣的环境下运行，对数据的安全性要求也更高，所以工控机通常会进行加固、防尘、防潮、防腐蚀、防辐射等特别设计 截止到目前，X86+Windows（Wintel）架构，依然是工控机的主流方案，可被定义为传统工控机。一般而言

在传统工控机在工控领域的自动化和信息化方面发挥重要作用的同时，其先天弱势也一直困扰着厂家、集成商和用户。大家都在寻找更好的方案

近十年来，嵌入式系统发展迅速，以其具有的低功耗、低成本及不断提升的高性能等特点，已经成为移动设备（手机、PAD）的唯一方案；也成为包括工业控制在内的各行业实现数据采集处理的理想选择ARM架构的嵌入式系统，具有的灵活高效的软硬件方案定制特点，目前已经形成完整的产业链生态圈，能够为用户提供满足其现实需求、并有一定超前扩展余度的产品，且价格更有竞争优势的产品；当用户需求逐渐超出目前产品的能力时，又能够通过快速的方案设计与迭代，不断提供满足用户要求的新产品，能够实现“需求——技术——方案——产品——市场——用户——需求“不断上升的良性循环

相对于传统工控机，经特殊设计的基于嵌入式计算机架构的系统，被称为嵌入式工控机

传统工控机与嵌入式工控机的主要特点对比如下：

[options="header",cols="1,2,4,5"]
|====
|序号	|关键要素	|传统工控机（Windows+X86）	|嵌入式工控机（Linux+LoongArch/ARM）
|1	|性能	|商用级赛扬或商业/工业级酷睿i3~I5	|工业级，性能高于赛扬，弱于I3
|2	|安全性	|漏洞多，易受病毒和黑客攻击	|系统稳定、较少升级，安全性高
|3	|实时性	|实时响应能力较差	|实时响应能力能够满足要求
|4	|可靠性	|高功耗必须强散热，可靠性低	|低功耗无需考虑散热，可靠性高
|5	|扩展性	|在主板上扩展各类接口复杂	|在核心板/开发板上扩展各类接口较为方便
|6	|工业级	|实现真正工业级产品较为困难	|实现真正工业级产品较为容易
|7	|定制化	|定制化效率低、成本高	|面向应用快速高效订制与迭代
|8	|性能	|对工业应用而言性能不足或过剩	|针对应用，具有最佳性能方案
|9	|总体价格	|较高	|针对应用，具有价格优势
|10	|运维成本	|功耗高、运维成本高	|低功耗低成本，绿色环保
|11	|生命周期	|换代频繁，库存难以保证	|CPU生命周期较长，可保证库存
|====

嵌入式工控机已经成为传统工控机的强力竞争对手。在未来，前者形成对后者的压倒性优势，毫无悬念

== 嵌入式工控机的应用场景

工业互联网及物联网的迅速发展，既是一场众多的计算机软硬件厂家（也包括通讯方案和产品厂家，其本质也是计算机系统，甚至是嵌入式系统的软硬件厂家）尝试进入利润相对较高的行业监控市场的前赴后继的尝试；也是一场开启“民觉民智”，普及专业知识的启蒙运动。这个已经持续了十数年的大风暴，使普罗大众对监视和控制的应用需求和想象，扩展到了各行各业的每个角落

“云—管—边—端”的概念，是以互联网思维和术语，对监视控制原理做了经典的总结与归纳；但从技术发展历史看，它远非全新概念和新技术，实际上是数十年来各行业监控应用所采用的主流模式和架构

image::/bpi-5202/industrial_computer_zh_1.png[industrial_computer_zh_1.png]

* 云：实现监控中心系统及更多高级应用软件和算法的计算机系统。这里的“云”，既包括互联网上的“公有云”，也包括企业局域网上的“私有云”。构建“云”的计算机系统，目前主要为高端X86+Windows/Linux服务器，及其集群
* 管：为设备两侧提供各种效率、可靠、便捷、高性价比的有线/无线通道。不仅在“云”和”边“之间有“管”的存在，例如广域以太网网、4G/5G等；在应用现场的“边”和“端”之间，也有适合现场应用场景的有线/无线的“管”的存在，比如局域以太网、串口、高速电力线载波（HPLC）、LoRa、ZigBee、WIFI等
* 边：用于完成现场计算任务的计算机系统。边”的主要角色，早期由传统工控机、或者在要求不那么严格时，用一般的台式机及服务器来承担；目前开始出现以中高端ARM架构嵌入式系统构建嵌入式工控机的趋势
* 端：用于实现对行业应用中对主设备（一次设备）进行监视和控制的装置（二次设备）、以及物联网环境中对各类主设备进行监控的设备（二次设备）。“端”的主要角色，早期由低端的嵌入式单片机系统实现；目前以逐渐过渡到以中低端嵌入式系统（主频1GMHz以下）为主流方案

从以上的分析不难看出，工控机的应用，主要定位在“边”的层面。作为“边”的具体应用，嵌入式工控机主要承载以下两种类型的功能：

* 自动运行类，如网关、NVR、路由器、防火墙等，通过特别设计的工业级中低档嵌入式计算机系统实现。部分具有简单的基于字符/位图的展示和特殊按键的参数配置和状态显示功能
* 交互运行类，完成监控和系统（含HMI人机交互界面）等功能，通过特别设计的工业级中高档嵌入式计算机系统实现，具有矢量化图形系统的交互能力

从以上的分析不难看出，工控机的应用，主要定位在“边”的层面。作为“边”的具体应用，嵌入式工控机主要承载以下两种类型的功能：

* 自动运行类，如网关、NVR、路由器、防火墙等，通过特别设计的工业级中低档嵌入式计算机系统实现。部分具有简单的基于字符/位图的展示和特殊按键的参数配置和状态显示功能
* 交互运行类，完成监控和系统（含HMI人机交互界面）等功能，通过特别设计的工业级中高档嵌入式计算机系统实现，具有矢量化图形系统的交互能力

嵌入式系统的CPU种类很多:

* ARM系列，国外的有：恩智浦（NXP）、高通（QUALCOMM）、德州仪器（TI）、三星（SAMSUNG）；国内的有：飞腾、全志、瑞星微、海思等
* 龙芯（LoongArch）系列，龙芯家族中的2系列，主要面向“边“及高级“端”的应用；1系列，主要面向中低级“端”的应用。

== BPI-5202 软件说明


=== 软件层次说明

在BPI-5202的硬件平台上，开源社区与吉斯凯达以授权方式（可选）提供部署了面向工业应用的应用开发环境和开发套件，功能全面、结构合理、扩展性强、精简高效，开发者可以根据不同的应用需求，开发功能各异的最终产品。

image::/bpi-5202/bpi-5202_soft.jpg[bpi-5202_soft.jpg]

* 硬件板卡资源层
** 在140mm x 100mm（8层板）单板上，集成了LoongArch 2K1000LA CPU、DDR及各种IO接口电路，实现操作系统级的所有IO驱动。
* 软件基本资源层
** 通过与IO驱动（包括串口RS232/RS485、网口、CAN、4G/5G、WIFI、PCIe等）的交互，实现协议解析（300+协议库）、MQTT服务、实时数据库、时序数据库（历史数据库）、关系数据库（历史数据库）、音视频推拉流/Onvif/GB28181等功能。
* 应用功能扩展层
** 通过与协议解析器、实时数据库、时序数据库、历史数据库的交互，实现各种数据处理应用功能的扩展。
* 应用服务层
** 可动态扩展的轻量级C+HTTP应用服务器，无需庞大繁杂不稳定的中间件，实现高效的应用服务。
** 这个服务机制既可以直接与应用展示层的C/S架构的HMI/SCADA交互；又可以通过发布层的Nginx服务器，为设备配置、B/S HMI交互、外部接口调用，提供服务。
** 流媒体服务器，直接与软件基本资源层的推拉流/云台控制组件交互，并通过发布层的Nginx服务器，为B/S HMI交互、外部接口调用，提供服务。
* 应用发布层
** Nginx服务器，通过反向代理机制，为应用展示层和外部接口，提供各类服务。
* 应用展示层
** 通过C/S与B/S的方式，提供HMI人机交互，和外部接口。

=== 2．主要应用功能
* a.工控全功能组合：
** 具有PLC、网关、视频监控、网络安全、上位机组态软件等功能，可分可合，灵动面对不同应用场景。
* b.多协议支持：
** 支持多达300多个工业协议库的协议转换机，覆盖电力、水利水务、石油石化、轨道交通、PLC、CNC、物联网、机器人控制、视频监控等行业协议的协议数据解析。
* c.统一数据处理
** 电气量IO数据（AIAODIDO）、协议数据与视频流媒体的整合和联动，网口、串口、有线无线、4G/5G统一处理。
* d.统一数据模型：
** 以实时数据库为载体的协议数据、协议模型和协议扩展框架，为新协议开发，提供了极大的便利。
* e.支持关系数据库与时序数据库：
** 支持数据向关系数据库（Sqlite、MySQL）和时序数据库（InfluxDB）的读写，全面支持多变的上层数据处理与分析需求。
* f.SCADA功能：
** 内置高性能、多功能的C/S+B/S架构轻量级SCADA系统（嵌入式全功能组态软件），架构简单、高效、一体化设计。
* g.HMI功能
** 既可通过HDMI/USB实现触摸屏人机交互（C/S、B/S），也可通过浏览器实现网络方式的人机交互（B/S）。
* h.轻量级WEB服务器
** 无需配置TOMCAT等厚重的中间件，内嵌轻量级HTTP/MQTT服务，简捷、高效、安全、可靠。
* i.双机冗余
** 支持双网/双节点主备冗余机制，为高性能、高可靠性需求提供保障
* j.多种二次开发套件
** 提供多种二次开发工具的API和开发环境，包含C/C++、QSA、JAVA、JS、Python下的API接口，实现增值应用的多样性与便捷性。

== BPI-5202典型应用场景

=== 常规网关
网关，是边缘侧其它应用设备的基础。

BPI-5202具备多种通信接口、并可灵活扩展；具有海量南北向通信协议库；开发者可通过开放框架定制新协议、配置网关各种参数、并实现与云平台的对接。

=== 边缘计算单元

* 利用BPI-5202丰富的资源和算力，可以在BPI-5202常规网关的基础上，实现边缘计算单元的功能。
* 针对协议解析之后存储于实时数据库中的数据，可以进行数据处理、计算、报警、断点续传、脚本/表达式运算的各种深度处理；通过实时数据库接口，实现与关系数据库/时序数据库的对接，实现报警、查询、历史数据存取等高级功能。在上述基础上，能够实现更多的定制化应用开发，从而实现边缘计算的能力。
* 通常网关/边缘计算单元是没有本地HMI交互、而通过网络配置和浏览/操作的“黑盒”产品；但根据5202的产品特点和差异化竞争优势考虑，也可以选择有HDMI/USB的交互方式。
* 其它特殊需求的通信（如Lora、ZigBee等）、数采功能，可通过定制板卡和定制机壳开口实现。

=== 边缘侧视频AI分析装置

近年来，现场视频AI分析的需求越来越强烈。但视频AI分析功能，也只是现场各种监控手段的一种，无法独立存在；另一方面，视频分析的准确率永远也无法达到100%，所以必须综合现场其它的监控手段，综合判断、协调处理。

BPI-5202本身缺少AI算力，但具有强大的数据处理能力与设备整合能力，与独立的视频AI分析装置进行整合，能够形成全新的、更有竞争优势、更能满足现场需求的产品。

这个方案，可以选择采用算力棒/算力卡/AI盒子整合等几种方式。

* 算力棒: 通过CS5202LS外置的USB插口，实现与算力棒的物理连接，并实现与BPI-5202中相关软件模块的对接。这种方式，实现最为简单。算力棒的算力一般在0.5~1TOPS之间，只能应用于几路或者较为常规的视频AI分析。
* 算力卡：通过BPI-5202内置的PCIe接口，实现与算力卡的物理连接，并实现与BPI-5202中相关软件模块的对接。这种方式，实现稍微复杂，需要另行定制机壳，算力卡的算力一般在2~6TOPS之间，能够支持多路或者较为复杂的视频AI分析。
* AI盒子整合：通过BPI-5202外置的LAN接口，实现与AI盒子的物理连接，并实现与BPI-5202中相关软件模块的对接。这种方式，实现简单，可以另外定制机壳，也可以将两个装置分立部署或者整合于一个更大的机箱中。AI盒子的算力弹性较大，能够对更多的视频通道进行处理，或者实现复杂的视频AI分析功能。

=== 风光储协调控制器

利用多种通信接口，并具有海量南北向通信协议库；通过开放框架定制新协议，形成对风光储哥子系统的数据采集与控制机制，高效、稳定，扩展便捷。对控制器中的数据，能够进行处理、计算、报警、断点续传、脚本/表达式运算、算法应用植入，满足智能化计算需要。

通过内置的HMI/SCADA功能，通过HDMI/USB实现与触摸屏的交互。

其它特殊需求的通信（如Lora、ZigBee等）、数采功能，可通过定制板卡和定制机壳开口实现。

=== 嵌入式工控机

有满足绝大部分工业控制需求的算力，有显示/输入交互能力、有大容量硬盘，为开发者提供面向工控需求的应用程序的开发和运行环境。

根据用户需求，可以扩展更多的网络、串口、电气量（AIAODIDO）模块。

其它特殊需求的通信（如Lora、ZigBee等）、数采功能，可通过定制板卡和定制机壳开口实现。

* 智能配电房、机房动力环境、泵站、智慧园区、智慧校园、智能制造等现场的边缘“大脑”，实现与现场数采单元、测控装置、保护设备、PLC设备、CNC设备、机器人设备的接入、协议解析、报警处理、转换、整合传输与控制
* 嵌入式SCADA系统（C/S、B/S模式）
* 100ms级别的软PLC
* 工控/物联网现场小型数据服务器
* 满足“智改数转”要求的企业车间级工业看板/OEE看板、轻量级MES前端数采和展示
* 基于行业应用的第三方算法、模型的开发与运行平台
* 视频前端设备的接入与推送、视频录像与联动、视频AI分析接口及分析结果的综合联动
* 现场网络安全及审计

image::/bpi-5202/banana_pi_bpi-5202_map.jpg[banana_pi_bpi-5202_map.jpg]

=== 通用工业控制器

通用控制器运行Linux操作系统，通过iDevToolkit开发套件，能够实现基于各种功能组件的面向工控需求的应用程序的开发和运行，包括但不限于：

具有通信协议解析功能、电气量IO（AIAODIDO）连接和数据处理功能、HMI功能、ms级PLC逻辑编程与控制（IEC61131）功能、C/Java/JS/Python/数据库等多种形式的编程接口。

根据不同需求，可在基本配置和满配中，定制不同的板卡-机壳。

其它特殊需求的通信（如Lora、ZigBee等）、数采功能，可通过定制板卡和定制机壳开口实现。

=== 现场数据+视频监控一体化服务器

视频监控，是现场整体方案的重要部分。但常规的方案中，一直存在视频监控系统与数据监控系统整合难度高、在广域网环境下费用高（包括流量费）的短板。
iDevToolkit工控开发组件及iCtrlPackage完美地解决了融合问题，以更低的造价、更高的安全性，实现数据监控与视频监控的一体化，实现报警的触发、联动、水印、记录、回放等功能；能通过DIDO模块实现对监控环境的联动感知和控制，整合视频AI分析功能，高效实现多维智能监控

其它特殊需求的通信（如Lora、ZigBee等）、数采功能，可通过定制板卡和定制机壳开口实现。

=== 轻量级PLC

面向测控点数在数十点以内、也可通过以太网/CAN/RS485扩展更多测控点的分布式应用场景，实现实时性指标在0.1s级别的常规PLC所具有的IEC61131编程/运行功能；通过灵活多变的通讯端口部署、协议解析（含第三方开发框架）与数据共享能力，实现分布式的实时处理、数据共享与联动。

其它特殊需求的通信（如Lora、ZigBee等）、数采功能，可通过定制板卡和定制机壳开口实现。

=== 工业机器人控制器

工业机器人控制器，通常采用实时操作系统和Ethercat通信方式，实现对多轴工业机器人的高精度实时控制。

BPI-5202可以部署实时操作系统，实现微秒级的实时响应性能，支持Ethercat主站协议，为开发者提供工业机器人控制器的运行平台。

作为工业机器人控制器，5202既能够通过Ethercat主站，与Ethercat子站模式的执行器连接通信‘；也能够通过附加的其它通讯端口（网口或串口）及IO模块与控制中心和周边的设备交互，扮演现场主控单元的角色。

=== HMI（轻量级组态软件）

HMI是工业现场常用的集信号处理、协议解析、数据处理、人机图形交互的计算机设备，BPI-5202可以部署C/S或B/S架构的HMI软件。

=== 创新型、特殊定制的产品

上述功能的组合产品，或者开发者根据不同现场的需求，自己定义的产品。

== 应用模式
* 1．原位替代：
** 任何现场、任何方案中所采用的自动化设备，都能在iCtrlPackage中找到对应的替代产品，功能更强大、性能更高效、运行更安全，寿命更长久。
* 2．整合替代：
** 以创新的思维、紧抓嵌入式系统性能快速提升的机遇，通过持续迭代的专项研发和技术融合，使得以5202单板工控机+ iDevToolkit +iCtrlPkg构成单一设备，替代常规方案中必须由多个常规设备才能构成现场应用系统的理想，成为现实，造价更低廉、架构更简捷、调试更方便、运维更高效。

= 合作方式

1,BPI-5202为一款开源硬件产品，Banana Pi 社区提供所有的BSP板级支持代码，并在代码中支持Docker容器。 有技术开发能力的客户，直接在BPI-5202上进行二次应用开发。

2,BPI-5202作为二次开发的基础平台，为应用开发者提供各类开发工具和协议解析数据库接口，大大缩短各类行业应用产品的开发周、降低开发难度

3,BPI-5202为完整工控产品，客户可以直接用来进行工业控制，提供完全的产品级支持。

= 样品购买

官方淘宝店： https://shop108780008.taobao.com/category-1760065991.htm?spm

OEM*ODM定制服务： judyhuang@banana-pi.com 
