= Introduction

Banana Pi BPI-SM9 16-ENC-A3 deep learning computing module is equipped with the highly integrated computing technology processor BM1688 8 Core ARM CA53 1.6GHz, 8GB LPDDR4，32GB eMMC onboard. It has 1 RJ45 Gigabit network port, 1 M.2 Key E, 1 M.2 Key M, 4 USB3.2 ports, 1 TYPE C (USB3.0) and multiple functional interfaces.

== Specifications
* Supports HDMI 2.0 output;
* Supports dual gigabit RJ45 Ethernet;
* Supports dual-layer USB3.0 interfaces;
* Supports dual-layer WIFI_BT function;
* Supports TF card or M.2 SSD expansion;
* Supports 2 MIPI camera inputs;
* Supports expansion of GPIO;
* Supports CAN function;
* Supports USB-C interface upgrade (NVIDVI core board solution);

= Development

== Prepare

* 12V/3A power adapter(The voltage range is between 11 and 13 volts. Using a 12V power adapter is the most suitable option.)

* Using your USB-Serial cable(3.3V TTL,Baud=115200) Connect to debug console on BPI-SM9

* One TF card(If you want to use the FT card for system startup)

* One Type-C cable (for upgrade programming)

=== TTL Debugport

image::/bpi-sm9/bpi-sm9-gettingstart/bananapi-pi_sm9_debugport.jpg.jpg[bananapi-pi_sm9_debugport.jpg.jpg]

== Jumper caps and the function
BPI-SM9 TF jumper cap and BPI-SM9 PWM control jumper cap

image::/bpi-sm9/bpi-sm9-gettingstart/bananapi-pi_sm9_jumper_cap1.jpg[bananapi-pi_sm9_jumper_cap1.jpg]

HDMI_DDC Voltage Connector jumper Cap

image::/bpi-sm9/bpi-sm9-gettingstart/bananapi-pi_sm9_jumper_cap2.jpg[bananapi-pi_sm9_jumper_cap2.jpg]

=== TF card detection and GPIO selection
NOTE: JP7 jumper instructions: (For BM1688)
1. Default connection: PIN2 and PIN3, used for enabling control of the WIFI module in the BM1688/NVIDIA module;
2. When using the TF card function of BM1688, the jumper of PIN1 and PIN2 is required, used for detecting the insertion of the TF card in BM1688;

[options="header",cols="1,1,1,5,1",width="90%"]
|====
5+| **BPI-SM9 TF jumper pins**
| Numbering position | PIN | PIN Definition | PIN Explanation | Level
.3+| JP7
| 1 | SDMMC_DET | TF card insertion detection | 1V8
| 2 | GPIOC0-SDMMC_DET | TF card insertion detection or universal GPIO | 1V8
| 3 | W_DISABLE1_CTRL | The WIFI enable control signal of the WiFi_BT module | 1V8

|====

=== PWM control jumper cap
NOTE: This jumper cap is used for PWM control of the FANs in different modules. By default, using the BM1688 module is sufficient.

[options="header",cols="1,1,1,5,1",width="90%"]
|====
5+| **BPI-SM9 PWM control jumper pins**
| Numbering position | PIN | PIN Definition | PIN Explanation | Level
.3+| JP8
| 1 | BM1688_FAN_PWM5 | The PWM control pin of BM1688 | 1V8
| 2 | FAN_PWM | The PWM control input of FAN | 1V8
| 3 | NVIDIA_FAN_PWM | NVIDIA's PWM control pin | 1V8
|====

=== HDMI_DDC Voltage Connector jumper Cap

NOTE: For the level selection of different modules, here it is assumed that 1.8V can be used.

[options="header",cols="1,1,1,5,2",width="90%"]
|====
5+| **BPI-SM9 HDMI_DDC Voltage Connector jumper pins**
| Numbering position | PIN | PIN Definition | PIN Explanation | Level
.3+| JP8
| 1 | 1V8 | Power supply 1.8V | 1V8
| 2 | VDD_DDC | The power supply options of DDC | 1V8 / 3V3
| 3 | 3V3 | Power supply 3.3V | 3V3
|====

= Accessories

== SD card burn image
NOTE: Please pay attention to whether the TF card clips on the board are correctly positioned. please see: link:https://docs.banana-pi.org/en/BPI-SM9/GettingStarted_BPI-SM9#_tf_card_detection_and_gpio_selection[TF card detection and GPIO selection]

. First, download the corresponding SD card burning package, and then copy the files in it to the SD card.

. Insert the card into the BPI-SM9 and power it on to start.

. Finally, it will automatically be updated and burned.

image::/bpi-sm9/bpi-sm9-gettingstart/bananapi-pi_sm9_sd_burn1.jpg[bananapi-pi_sm9_sd_burn1.jpg]


== OTG typeC burn image

. Please download and unzip the tool flashing package "usb_tool".
. Double-click on CviUsbInstallDriver.exe to install the driver for your PC.
. Open the Windows Command Prompt in the directory of the usb_dl.exe file and enter:
+
```bash
./usb_dl.exe -c cv186x -i usb\
```
image::/bpi-sm9/bpi-sm9-gettingstart/bananapi-pi_sm9_otgburn1.jpg[bananapi-pi_sm9_otgburn1.jpg]

. When the above interface appears, simply reinsert and remove the OTG type C interface to proceed with the burning process.

image::/bpi-sm9/bpi-sm9-gettingstart/bananapi-pi_sm9_otgburn2.jpg[bananapi-pi_sm9_otgburn2.jpg]

== USB3.0

image::/bpi-sm9/bpi-sm9-gettingstart/bananapi-pi_sm9_usbport1.jpg[bananapi-pi_sm9_usbport1.jpg]

```bash
admin@sophon:~$ lsblk
NAME         MAJ:MIN RM  SIZE RO TYPE MOUNTPOINTS
sda            8:0    1 14.8G  0 disk
└─sda1         8:1    1 14.8G  0 part /media/storage-hot-sda1
mmcblk0      179:0    0 28.9G  0 disk
├─mmcblk0p1  179:1    0  128M  0 part /boot
├─mmcblk0p2  179:2    0  128M  0 part /recovery
├─mmcblk0p3  179:3    0   10M  0 part
├─mmcblk0p4  179:4    0    7G  0 part /media/root-ro
├─mmcblk0p5  179:5    0    7G  0 part /media/root-rw
└─mmcblk0p6  179:6    0    4G  0 part /data
mmcblk0boot0 179:8    0    4M  1 disk
mmcblk0boot1 179:16   0    4M  1 disk
```

== Uart1

image::/bpi-sm9/bpi-sm9-gettingstart/bananapi-pi_sm9_uart1.jpg[bananapi-pi_sm9_uart1.jpg]

=== send
Use script to send
```bash
admin@sophon:~/storage-hot-sda1$ cat uart_send.sh
#!/bin/bash

# 检查传入的参数数量是否正确
if [ $# -ne 2 ]; then
    echo "用法: $0 <串口设备名称> <波特率>"
    echo "示例: $0 /dev/ttyS1 9600"
    exit 1
fi

# 获取传入的串口设备名称和波特率
serial_device=$1
baud_rate=$2

# 配置串口设备
sudo stty -F $serial_device $baud_rate raw

# 要发送的数据
data="hello, hdzk!\r\n"

# 无限循环发送数据
while true; do
    echo -e "$data" | sudo tee $serial_device > /dev/null
    if [ $? -ne 0 ]; then
        echo "数据发送失败。"
        break
    fi
    sleep 1
done
```
image::/bpi-sm9/bpi-sm9-gettingstart/bananapi-pi_sm9_uart2.jpg[bananapi-pi_sm9_uart2.jpg]

=== receive
Use script to receive
```bash
admin@sophon:~/storage-hot-sda1$ cat uart_send.sh
#!/bin/bash

# 检查传入的参数数量是否正确
if [ $# -ne 2 ]; then
    echo "用法: $0 <串口设备名称> <波特率>"
    echo "示例: $0 /dev/ttyS1 9600"
    exit 1
fi

# 获取传入的串口设备名称和波特率
serial_device=$1
baud_rate=$2

# 配置串口设备
sudo stty -F $serial_device $baud_rate raw

# 要发送的数据
data="hello, hdzk!\r\n"

# 无限循环发送数据
while true; do
    echo -e "$data" | sudo tee $serial_device > /dev/null
    if [ $? -ne 0 ]; then
        echo "数据发送失败。"
        break
    fi
    sleep 1
done
```

Received on the board
```bash
admin@sophon:~/storage-hot-sda1$ ./uart_receive.sh /dev/ttyS1 9600
123hello▒▒testhello▒▒testhello
testhello
testhello
testhello
test
```

image::/bpi-sm9/bpi-sm9-gettingstart/bananapi-pi_sm9_uart3.jpg[bananapi-pi_sm9_uart3.jpg]

= GPIO Define
== 40-pin interface
NOTE: The default level of the 40-pin GPIO is 3.3V (except for the 5V pin)
[%collapsible]
====

[options="header",cols="3,1,1,4",width="70%"]
|====
4+| **BPI-SM9 40 PIN Header GPIO define of JP41**
|BPI-SM9-CON	|PIN		|PIN	|BPI-SM9-CON
| 5V | 1 | 2 | 3V3
| 5V | 3 | 4 | I2C1_SDA
| GND | 5 | 6 | I2C1_SCL
| UART1_TXD | 7 | 8 | GPIO09
| UART1_RXD | 9 | 10 | GND
| I2S0_SCLK | 11 | 12 | UART1_RTS
| GND | 13 | 14 | SPI1_SCK
| SPI1_CS1 | 15 | 16 | GPIO12
| SPI1_CS0 | 17 | 18 | 3V3
| GND | 19 | 20 | SPI0_MOSI
| SPI1_MISO | 21 | 22 | SPI0_MISO
| SPI0_CS0 | 23 | 24 | SPI0_SCK
| SPI0_CS1 | 25 | 26 | GND
| ID_I2C_SCL | 27 | 28 | ID_I2C_SDA
| GND | 29 | 30 | GPIO01
| GPIO07 | 31 | 32 | GPIO11
| GND | 33 | 34 | GPIO13
| UART1_CTS | 35 | 36 | I2S0_LRCK
| I2S0_SDIN | 37 | 38 | SPI1_MOSI
| I2S0_SDOUT | 39 | 40 | GND

====

== Fan control interface

[%collapsible]
====

[options="header",cols="1,1,1",width="70%"]
|====
3+| **BPI-SM9 Fan control interface of JP4**
|PIN	| Definition		| Level	
| 1 | GND | / 
| 2 | 5V | 5V 
| 3 | TACH | 5V
| 4 | PWM | 5V 

====

== POE interface

[%collapsible]
====

[options="header",cols="1,1,1",width="70%"]
|====
3+| **BPI-SM9 POE interface of JP38**
|PIN	| Definition		| Level	
| 1 | POE_VC2 | / 
| 2 | POE_VC1 | / 
| 3 | POE_VC4 | /
| 4 | POE_VC3 | /

====

== CANH/L interface

[%collapsible]
====

[options="header",cols="1,1,1",width="70%"]
|====
3+| **BPI-SM9 CANH/L interface of JP5**
|PIN	| Definition		| Level	
| 1 | CANH | 3V3 
| 2 | CANL | 3V3 
| 3 | GND | /
| 4 | 3V3 | 3V3

====

== 12-pin interface

[%collapsible]
====

[options="header",cols="1,1,1",width="70%"]
|====
3+| **BPI-SM9 12-pin interface of JP50**
|PIN	| Definition		| Level	
| 1 | PC_LED- | 5V 
| 2 | PC_LED+ | 5V 
| 3 | UART2_RX | 3V3
| 4 | UART2_TX | 3V3
| 5 | LATCH_SET | 5V 
| 6 | LATCH_SET_BUT | 5V
| 7 | GND | /
| 8 | SYS_RST | 1V8
| 9 | GND | /
| 10 | FORCE_RECOVERY | 1V8 
| 11 | GND | /
| 12 | PWR_BTN | 5V

====

== Camera interface
=== Camera1
[%collapsible]
====

[options="header",cols="1,1,1",width="70%"]
|====
3+| **BPI-SM9 Camera1 of JP13**
|PIN	| Definition		| Level	
| 1 | GND | /
| 2 | NC | / 
| 3 | CSI2_D0_N | 1V8
| 4 | NC | /
| 5 | CSI2_D0_P | 1V8 
| 6 | NC | /
| 7 | GND | /
| 8 | NC | /
| 9 | CSI2_D1_N | 1V8
| 10 | NC | 1V8 
| 11 | CSI2_D1_P | 1V8
| 12 | NC | /
| 13 | GND | / 
| 14 | NC | /
| 15 | CSI2_CLK_N | 1V8
| 16 | NC | /
| 17 | CSI2_CLK_P | 1V8 
| 18 | NC | /
| 19 | GND | /
| 20 | NC | /
| 21 | CAM1_PWDN | 1V8
| 22 | NC | /
| 23 | CAM1_MCLK | 1V8
| 24 | NC | /
| 25 | CAM1_I2C_SCL | 3V3 
| 26 | NC | / 
| 27 | CAM1_I2C_SDA | 3V3
| 28 | NC | /
| 29 | 3V3 | 3V3 
| 30 | NC | /

====

=== Camera2
[%collapsible]
====

[options="header",cols="1,1,1",width="70%"]
|====
3+| **BPI-SM9 Camera2 of JP49**
|PIN	| Definition		| Level	
| 1 | GND | /
| 2 | NC | / 
| 3 | CSI0_D0_N | 1V8
| 4 | NC | /
| 5 | CSI0_D0_P | 1V8 
| 6 | NC | /
| 7 | GND | /
| 8 | NC | /
| 9 | CSI0_D1_N | 1V8
| 10 | NC | 1V8 
| 11 | CSI0_D1_P | 1V8
| 12 | NC | /
| 13 | GND | / 
| 14 | NC | /
| 15 | CSI0_CLK_N | 1V8
| 16 | NC | /
| 17 | CSI0_CLK_P | 1V8 
| 18 | NC | /
| 19 | GND | /
| 20 | NC | /
| 21 | CAM0_PWDN | 1V8
| 22 | NC | /
| 23 | CAM0_MCLK | 1V8
| 24 | NC | /
| 25 | CAM0_I2C_SCL | 3V3 
| 26 | NC | / 
| 27 | CAM0_I2C_SDA | 3V3
| 28 | NC | /
| 29 | 3V3 | 3V3 
| 30 | NC | /

====
